<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Estimates when and where a model-guided treatment strategy may outperform 
    a treat-all or treat-none approach by Monte Carlo simulation and evaluation of the Net Monetary Benefit (NMB).">
<title>Evaluate Clinical Prediction Models by Net Monetary Benefit â€¢ predictNMB</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="apple-touch-icon-60x60.png">
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Evaluate Clinical Prediction Models by Net Monetary Benefit">
<meta property="og:description" content="Estimates when and where a model-guided treatment strategy may outperform 
    a treat-all or treat-none approach by Monte Carlo simulation and evaluation of the Net Monetary Benefit (NMB).">
<meta property="og:image" content="https://rwparsons.github.io/predictNMB/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="index.html">predictNMB</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="articles/predictNMB.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="articles/creating-nmb-functions.html">Creating NMB functions</a>
    <a class="dropdown-item" href="articles/detailed-example.html">Detailed example: pressure injury model</a>
    <a class="dropdown-item" href="articles/summarising-results-with-predictNMB.html">Summarising results from predictNMB</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/rwparsons/predictNMB/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header">
<img src="logo.png" class="logo" alt=""><h1 id="predictnmb-">predictNMB 
<a class="anchor" aria-label="anchor" href="#predictnmb-"></a>
</h1>
</div>
<!-- badges: start -->

<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>predictNMB is a tool to evaluate (hypothetical) clinical prediction models based on their estimated Net Monetary Benefit (NMB). It may be used by prediction model developers who intend to find out how performant their model needs to be to be clinically useful or by those in health services deciding whether or not to implement an existing model.</p>
<p><a href="https://rwparsons.github.io/predictNMB/">predictNMB</a> has two main functions:</p>
<ul>
<li>
<code><a href="reference/do_nmb_sim.html">do_nmb_sim()</a></code>: takes user defined inputs for a given prediction model and population, then evaluates the NMB by performing simulations.</li>
<li>
<code><a href="reference/screen_simulation_inputs.html">screen_simulation_inputs()</a></code>: calls <code><a href="reference/do_nmb_sim.html">do_nmb_sim()</a></code> many times, using a range of values for any of its inputs. This is useful for sensitivity analysis.</li>
</ul>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the development version from <a href="https://github.com/" class="external-link">GitHub</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("remotes")</span></span>
<span><span class="fu">remotes</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"RWParsons/predictNMB"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="estimating-model-cutpoints">Estimating model cutpoints<a class="anchor" aria-label="anchor" href="#estimating-model-cutpoints"></a>
</h2>
<p>We must first define a hypothetical NMB associated with each square of a confusion matrix (2x2 table). To do this, we create an R function which, when run, returns a named vector representing the four NMB values that we need. <code><a href="reference/get_nmb_sampler.html">get_nmb_sampler()</a></code> is a <code>predictNMB</code> function that makes creating the function easier!</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rwparsons.github.io/predictNMB/">predictNMB</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">fx_nmb</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/get_nmb_sampler.html">get_nmb_sampler</a></span><span class="op">(</span></span>
<span>  outcome_cost <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  high_risk_group_treatment_effect <span class="op">=</span> <span class="fl">0.35</span>,</span>
<span>  high_risk_group_treatment_cost <span class="op">=</span> <span class="fl">10</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">fx_nmb</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;   TP   FP   TN   FN </span></span>
<span><span class="co">#&gt;  -75  -10    0 -100</span></span></code></pre></div>
<p>We can then pass this to the simulation function. Required arguments:</p>
<ul>
<li>
<code>n_sims</code>: number of simulations to run. More simulations take longer, but are more stable.</li>
<li>
<code>event_rate</code>: event incidence rate, or the proportion of patients experiencing the event.</li>
<li>
<code>sim_auc</code>: vector of hypothetical AUCs; e.g.Â <code>seq(0.7, 0.95, 0.05)</code> or <code>c(0.75, 0.80, 0.85)</code>.</li>
<li>
<code>n_valid</code>: number of samples the validation set draws within each simulation (evaluating the NMB under each cutpoint).</li>
<li>
<code>fx_nmb_training</code>: function that returns a named vector used to get cutpoints on the training set. Recommended to use constant values.</li>
<li>
<code>fx_nmb_evaluation</code>: function that returns a named vector used to get cutpoints on the evaluation set. Recommended to use sampled values.</li>
<li>
<code>cl</code>: (Optional) users can pass a cluster made using <code><a href="https://rdrr.io/r/parallel/makeCluster.html" class="external-link">parallel::makeCluster()</a></code>. If it is given, the simulations are run in parallel (faster).</li>
</ul>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">parallel</span><span class="op">)</span></span>
<span><span class="va">cl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/parallel/makeCluster.html" class="external-link">makeCluster</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/parallel/detectCores.html" class="external-link">detectCores</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sim_screen_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/screen_simulation_inputs.html">screen_simulation_inputs</a></span><span class="op">(</span></span>
<span>  n_sims <span class="op">=</span> <span class="fl">1000</span>, n_valid <span class="op">=</span> <span class="fl">10000</span>, sim_auc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.7</span>, <span class="fl">0.95</span>, <span class="fl">0.05</span><span class="op">)</span>, event_rate <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  fx_nmb_training <span class="op">=</span> <span class="va">fx_nmb</span>, fx_nmb_evaluation <span class="op">=</span> <span class="va">fx_nmb</span>,</span>
<span>  cutpoint_methods <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"all"</span>, <span class="st">"none"</span>, <span class="st">"youden"</span><span class="op">)</span>, cl <span class="op">=</span> <span class="va">cl</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>These simulations can be interpreted as a range of hypothetical situations under different levels of model performance within our specific healthcare setting. We can visualise how this change may affect preferences between the model-guided strategy versus a treat-all or treat-none strategy â€” in other words, using the model to determine who should get treatment, rather than everyone or no-one.</p>
<p><code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> on the object returned from this function to quickly inspect these trends:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sim_screen_obj</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-6-1.png" width="100%"></p>
<p>Here, we are visualising many simulations under different inputs. If we just want to inspect a single set of inputs, say when the model AUC is 0.9, we can run that simulation alone using <code><a href="reference/do_nmb_sim.html">do_nmb_sim()</a></code>, or access it from our existing screen.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">single_sim_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/do_nmb_sim.html">do_nmb_sim</a></span><span class="op">(</span></span>
<span>  n_sims <span class="op">=</span> <span class="fl">1000</span>, n_valid <span class="op">=</span> <span class="fl">10000</span>, sim_auc <span class="op">=</span> <span class="fl">0.9</span>, event_rate <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  fx_nmb_training <span class="op">=</span> <span class="va">fx_nmb</span>, fx_nmb_evaluation <span class="op">=</span> <span class="va">fx_nmb</span>,</span>
<span>  cutpoint_methods <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"all"</span>, <span class="st">"none"</span>, <span class="st">"youden"</span><span class="op">)</span>, cl <span class="op">=</span> <span class="va">cl</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">single_sim_obj</span> <span class="op">&lt;-</span> <span class="va">sim_screen_obj</span><span class="op">$</span><span class="va">simulations</span><span class="op">[[</span><span class="fl">6</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<p>When plotting a single set of simulation inputs, we see the distributions of the NMB across all simulations under each strategy.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">single_sim_obj</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-9-1.png" width="100%"></p>
</div>
<div class="section level2">
<h2 id="citation">Citation<a class="anchor" aria-label="anchor" href="#citation"></a>
</h2>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/citation.html" class="external-link">citation</a></span><span class="op">(</span><span class="st">"predictNMB"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; To cite predictNMB in publications use:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Parsons R, Blythe R, Barnett A (2022). _predictNMB: Evaluate Clinical</span></span>
<span><span class="co">#&gt;   Prediction Models by Net Monetary Benefit_. 0.0.1,</span></span>
<span><span class="co">#&gt;   &lt;https://github.com/RWParsons/predictNMB&gt;.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; A BibTeX entry for LaTeX users is</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   @Manual{,</span></span>
<span><span class="co">#&gt;     title = {{predictNMB}: Evaluate Clinical Prediction Models by Net Monetary Benefit},</span></span>
<span><span class="co">#&gt;     author = {Rex Parsons and Robin Blythe and Adrian Barnett},</span></span>
<span><span class="co">#&gt;     year = {2022},</span></span>
<span><span class="co">#&gt;     note = {0.0.1},</span></span>
<span><span class="co">#&gt;     url = {https://github.com/RWParsons/predictNMB},</span></span>
<span><span class="co">#&gt;   }</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="further-reading">Further reading<a class="anchor" aria-label="anchor" href="#further-reading"></a>
</h2>
<p>The <a href="https://rwparsons.github.io/predictNMB/"><code>predictNMB</code> website</a> and its vignettes:</p>
<ul>
<li><a href="https://rwparsons.github.io/predictNMB/articles/predictNMB.html">Getting started with <code>predictNMB</code></a></li>
<li><a href="https://rwparsons.github.io/predictNMB/articles/summarising-results-with-predictNMB.html">Summarising results from <code>predictNMB</code></a></li>
<li><a href="https://rwparsons.github.io/predictNMB/articles/detailed-example.html">Detailed example: pressure injury model</a></li>
<li><a href="https://rwparsons.github.io/predictNMB/articles/creating-nmb-functions.html">Creating NMB functions</a></li>
</ul>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/rwparsons/predictNMB/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/rwparsons/predictNMB/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small>GPL (&gt;= 3)</small></li>
</ul>
</div>

<div class="community">
<h2 data-toc-skip>Community</h2>
<ul class="list-unstyled">
<li><a href="CONTRIBUTING.html">Contributing guide</a></li>
</ul>
</div>

<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing predictNMB</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Rex Parsons <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0002-6053-8174" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Robin Blythe <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0002-3643-4332" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Adrian Barnett <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0001-6339-0374" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li><a href="authors.html">More about authors...</a></li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/RWParsons/predictNMB/actions" class="external-link"><img src="https://github.com/RWParsons/predictNMB/workflows/R-CMD-check/badge.svg" alt="R-CMD-check"></a></li>
<li><a href="https://www.gnu.org/licenses/gpl-3.0" class="external-link"><img src="https://img.shields.io/badge/License-GPLv3-blue.svg" alt="License: GPL v3"></a></li>
<li><a href="https://app.codecov.io/gh/RWParsons/predictNMB?branch=master" class="external-link"><img src="https://codecov.io/gh/RWParsons/predictNMB/branch/master/graph/badge.svg" alt="Codecov test coverage"></a></li>
<li><a href="https://www.repostatus.org/#active" class="external-link"><img src="https://www.repostatus.org/badges/latest/active.svg" alt="Project Status: Active â€“ The project has reached a stable, usable state and is being actively developed."></a></li>
<li><a href="https://github.com/RWParsons/predictNMB/actions?query=workflow%3Apkgcheck" class="external-link"><img src="https://github.com/RWParsons/predictNMB/workflows/pkgcheck/badge.svg" alt="pkgcheck"></a></li>
<li><a href="https://github.com/ropensci/software-review/issues/566" class="external-link"><img src="https://badges.ropensci.org/566_status.svg" alt="Status at rOpenSci Software Peer Review"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Rex Parsons, Robin Blythe, Adrian Barnett.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
